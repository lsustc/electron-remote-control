(this.webpackJsonpmain=this.webpackJsonpmain||[]).push([[0],{0:function(e,n){e.exports=require("electron")},12:function(e,n,t){},14:function(e,n,t){},16:function(e,n,t){"use strict";t.r(n);var r=t(3),c=t.n(r),a=t(7),i=t.n(a),o=(t(12),t(2)),s=t.n(o),u=t(4),d=t(5),p=(t(14),t(0));function f(){return l.apply(this,arguments)}function l(){return(l=Object(u.a)(s.a.mark((function e(){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.desktopCapturer.getSources({types:["screen"]});case 2:return n=e.sent,e.abrupt("return",new Promise((function(e,t){navigator.getUserMedia({audio:!1,video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:n[0].id,maxWidth:window.screen.width,maxHeight:window.screen.height}}},(function(n){e(n)}),(function(e){t(e)}))})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var h=new window.RTCPeerConnection({});h.ondatachannel=function(e){console.log("datachannel",e),e.channel.onmessage=function(e){var n=JSON.parse(e.data),t=n.type,r=n.data;"mouse"===t&&(r.screen={width:window.screen.width,height:window.screen.height}),p.ipcRenderer.send("robot",t,r)}},h.onicecandidate=function(e){e.candidate&&"{}"!==JSON.stringify(e.candidate)&&(console.log("puppet-candidate",JSON.stringify(e.candidate)),p.ipcRenderer.send("forward","puppet-candidate",JSON.stringify(e.candidate)))},p.ipcRenderer.on("candidate",(function(e,n){console.log("pu-can",n),b(JSON.parse(n.data))}));var w=[];function b(e){return v.apply(this,arguments)}function v(){return(v=Object(u.a)(s.a.mark((function e(n){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n&&w.push(n),!h.remoteDescription||!h.remoteDescription.type){e.next=10;break}t=0;case 3:if(!(t<w.length)){e.next=9;break}return e.next=6,h.addIceCandidate(new RTCIceCandidate(w[t]));case 6:t++,e.next=3;break;case 9:w=[];case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e){return j.apply(this,arguments)}function j(){return(j=Object(u.a)(s.a.mark((function e(n){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f();case 2:return t=e.sent,console.log("offer",n),h.addStream(t),e.next=7,h.setRemoteDescription(n.data);case 7:return e.t0=h,e.next=10,h.createAnswer();case 10:return e.t1=e.sent,e.next=13,e.t0.setLocalDescription.call(e.t0,e.t1);case 13:return console.log("answer",JSON.stringify(h.localDescription)),e.abrupt("return",h.localDescription);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}window.addIceCandidate=b,p.ipcRenderer.on("offer",function(){var e=Object(u.a)(s.a.mark((function e(n,t){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g(t);case 2:r=e.sent,p.ipcRenderer.send("forward","answer",{type:r.type,sdp:r.sdp});case 4:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}()),window.createAnswer=g;var x=t(1),m=p.remote.Menu,O=p.remote.MenuItem;var y=function(){var e=Object(r.useState)(""),n=Object(d.a)(e,2),t=n[0],c=n[1],a=Object(r.useState)(""),i=Object(d.a)(a,2),o=i[0],f=i[1],l=Object(r.useState)(""),h=Object(d.a)(l,2),w=h[0],b=h[1],v=function(){var e=Object(u.a)(s.a.mark((function e(){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.ipcRenderer.invoke("login");case 2:n=e.sent,f(n);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),g=function(e,n,t){var r="";r=1===t?"\u6b63\u5728\u8fdc\u7a0b\u63a7\u5236".concat(n):2===t?"\u88ab".concat(n,"\u63a7\u5236\u4e2d"):"",b(r)};return Object(r.useEffect)((function(){return v(),p.ipcRenderer.on("control-state-change",g),function(){p.ipcRenderer.removeListener("control-state-change",g)}}),[]),Object(x.jsx)("div",{className:"App",children:""===w?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("div",{children:["\u4f60\u7684\u63a7\u5236\u7801",Object(x.jsx)("span",{onContextMenu:function(e){return function(e){e.preventDefault();var n=new m;n.append(new O({label:"\u590d\u5236",role:"copy"})),n.popup()}(e)},children:o})]}),Object(x.jsx)("input",{type:"text",value:t,onChange:function(e){return c(e.target.value)}}),Object(x.jsx)("button",{onClick:function(){!function(e){console.log(p.ipcRenderer.send),p.ipcRenderer.send("control",e)}(t)},children:"\u786e\u8ba4"})]}):Object(x.jsx)("div",{children:w})})},S=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,17)).then((function(n){var t=n.getCLS,r=n.getFID,c=n.getFCP,a=n.getLCP,i=n.getTTFB;t(e),r(e),c(e),a(e),i(e)}))};i.a.render(Object(x.jsx)(c.a.StrictMode,{children:Object(x.jsx)(y,{})}),document.getElementById("root")),S()}},[[16,1,2]]]);
//# sourceMappingURL=main.9ec9c8ec.chunk.js.map